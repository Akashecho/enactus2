{% extends "layout.html" %}

{% block content %}
<section class="container" style="padding-top: 150px;">
    
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 3rem;">
        <h1>Admin Dashboard</h1>
        <a href="/logout" class="btn-primary" style="background: #000; color: #fff; border-color: #000;">Logout</a>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div style="padding: 1rem; margin-bottom: 2rem; border-radius: 8px; background: #fff; border-left: 4px solid var(--brand-yellow); box-shadow: 0 5px 20px rgba(0,0,0,0.05);">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem;">
        
        <!-- LEFT COLUMN: ADD EVENT FORM -->
        <div>
            <div style="background: #fff; padding: 2.5rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 1.5rem; border-bottom: 1px solid #eee; padding-bottom: 1rem;">Add New Event</h3>
                
                <form action="/add_event" method="POST">
                    
                    <div class="form-group">
                        <label>Event Title</label>
                        <input type="text" name="title" class="premium-input" placeholder="e.g. Annual Summit" required>
                    </div>

                    <div class="form-group">
                        <label>Event Date</label>
                        <input type="date" name="date" class="premium-input" required>
                    </div>

                    <div class="form-group">
                        <label>Short Description (Card)</label>
                        <input type="text" name="short_desc" class="premium-input" placeholder="One line summary" required>
                    </div>

                    <div class="form-group">
                        <label>Full Description (Dropdown)</label>
                        <textarea name="full_desc" class="premium-input" rows="4" style="border: 1px solid #eee; padding: 1rem; border-radius: 4px;" placeholder="Detailed info..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Image URL (Unsplash/Link)</label>
                        <input type="url" name="image_url" class="premium-input" placeholder="https://..." required>
                    </div>

                    <button type="submit" class="btn-primary" style="width: 100%;">Publish Event</button>
                </form>
            </div>
        </div>

        <!-- RIGHT COLUMN: REGISTRATIONS LIST -->
        <div>
            <div style="background: #fff; padding: 2.5rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 1.5rem; border-bottom: 1px solid #eee; padding-bottom: 1rem;">Recent Registrations ({{ regs|length }})</h3>

                <div style="max-height: 600px; overflow-y: auto;">
                    {% if regs|length == 0 %}
                        <p style="color: var(--text-muted);">No registrations yet.</p>
                    {% else %}
                        <table style="width: 100%; border-collapse: collapse; text-align: left;">
                            <thead>
                                <tr>
                                    <th style="padding-bottom: 1rem; color: #888; font-size: 0.8rem;">NAME</th>
                                    <th style="padding-bottom: 1rem; color: #888; font-size: 0.8rem;">EVENT</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for reg in regs %}
                                <tr style="border-bottom: 1px solid #f4f4f5;">
                                    <td style="padding: 1rem 0;">
                                        <div style="font-weight: 600;">{{ reg.name }}</div>
                                        <div style="font-size: 0.85rem; color: #666;">{{ reg.email }}</div>
                                        <div style="font-size: 0.8rem; color: #aaa;">ID: {{ reg.student_id }}</div>
                                    </td>
                                    <td style="padding: 1rem 0; vertical-align: top;">
                                        <span style="background: #FEF08A; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 700; color: #854D0E;">
                                            {{ reg.event.title }}
                                        </span>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                </div>
            </div>
        </div>

    </div>
</section>

<!-- Mobile Responsive Tweak -->
<style>
    @media (max-width: 900px) {
        div[style*="grid-template-columns"] {
            grid-template-columns: 1fr !important;
        }
    }
</style>
{% endblock %}